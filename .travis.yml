sudo: false
language: node_js

env:
  - YLOPS_SERVICE_DIR=$PWD/eperusteet-ylops/eperusteet-ylops-service

node_js:
  - "10.15.0"

install:
  - npm install -g codecov
  - git clone https://github.com/Opetushallitus/eperusteet-ylops
  - cd eperusteet-ylops && mvn dependency:resolve --quiet && cd ..
  - npm ci

script:
  - npm run gen:api
  - rm -rf eperusteet-ylops
  - npm run lint
  - npm run build
  - npm run test
  - codecov

cache:
  npm: true
  directories:
    - $HOME/.npm
    - $HOME/.m2
    - $HOME/.cache
